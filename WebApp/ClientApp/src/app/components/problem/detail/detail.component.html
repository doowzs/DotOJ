<div id="problem-detail" *ngIf="problem">
  <h2 id="problem-title">
    {{ problem.title }}
    <span style="float: right;">
      <button nz-button nzSize="small" nzShape="circle" style="margin-right: 0.5rem;"
              [nzLoading]="loading" (click)="loadProblem()">
        <i nz-icon nzType="sync"></i>
      </button>
      <nz-tag nzColor="purple" *ngIf="problem.hasSpecialJudge">
        <i nz-icon nzType="coffee"></i><span>Special Judge</span>
      </nz-tag>
      <nz-tag nzColor="green" *ngIf="problem.solved">
        <i nz-icon nzType="check"></i><span>Solved</span>
      </nz-tag>
      <small *ngIf="privileged">
        [<a nz-button nzType="link" nzDanger [routerLink]="['/admin/problem', problemId]">Edit</a>]
        [<a nz-button nzType="link" nzDanger [routerLink]="['/admin/problem', problemId, 'test-cases']">TestCases</a>]
      </small>
    </span>
  </h2>
  <div nz-row id="problem-stats">
    <div nz-col nzSpan="6">
      <nz-statistic nzTitle="Base Time Limit" [nzValue]="problem.timeLimit" nzSuffix="ms"></nz-statistic>
    </div>
    <div nz-col nzSpan="6">
      <nz-statistic nzTitle="Memory Limit" nzSuffix="MiB"
                    [nzValue]="(problem.memoryLimit / 1024 | number: '1.0-0' | noComma)"
      ></nz-statistic>
    </div>
    <div nz-col nzSpan="6">
      <nz-statistic nzTitle="Accepted" [nzValue]="problem.acceptedSubmissions"
                    [nzSuffix]="'of ' + problem.totalSubmissions"></nz-statistic>
    </div>
    <div nz-col nzSpan="6">
      <nz-statistic nzTitle="AC Ratio" nzSuffix="%"
                    [nzValue]="problem.totalSubmissions ? (problem.acceptedSubmissions / problem.totalSubmissions * 100 | number : '1.1-1') : '0.0'"
      ></nz-statistic>
    </div>
  </div>
  <nz-divider nzText="Submissions" nzOrientation="left"></nz-divider>
  <app-submission-creator [problem]="problem"></app-submission-creator>
  <app-submission-timeline [problem]="problem"></app-submission-timeline>

  <nz-divider nzText="Description" nzOrientation="left"></nz-divider>
  <markdown [data]="problem.description" katex></markdown>
  <nz-divider nzText="Input Format" nzOrientation="left"></nz-divider>
  <markdown [data]="problem.inputFormat" katex></markdown>
  <nz-divider nzText="Output Format" nzOrientation="left"></nz-divider>
  <markdown [data]="problem.outputFormat" katex></markdown>
  <nz-divider nzText="Sample Cases" nzOrientation="left"></nz-divider>
  <nz-descriptions *ngFor="let testCase of problem.sampleCases"
                   nzBordered nzLayout="vertical" nzColumn="2">
    <nz-descriptions-item [nzTitle]="inputTitle" nzSpan="1">
      <pre>{{ testCase.input }}</pre>
    </nz-descriptions-item>
    <nz-descriptions-item [nzTitle]="outputTitle" nzSpan="1">
      <pre>{{ testCase.output }}</pre>
    </nz-descriptions-item>
    <ng-template #inputTitle>
      <span>Input</span>
      <button nz-button nzSize="small" nzType="link" style="float: right;"
              nz-tooltip nzTooltipTitle="Copied!" nzTooltipTrigger="click"
              (click)="copyToClipboard(testCase.input)">
        <i nz-icon nzType="copy"></i>
      </button>
    </ng-template>
    <ng-template #outputTitle>
      <span>Output</span>
      <button nz-button nzSize="small" nzType="link" style="float: right;"
              nz-tooltip nzTooltipTitle="Copied!" nzTooltipTrigger="click"
              (click)="copyToClipboard(testCase.output)">
        <i nz-icon nzType="copy"></i>
      </button>
    </ng-template>
  </nz-descriptions>
  <ng-container *ngIf="problem.footNote">
    <nz-divider nzText="Foot Note" nzOrientation="left"></nz-divider>
    <markdown [data]="problem.footNote" katex></markdown>
  </ng-container>
</div>
